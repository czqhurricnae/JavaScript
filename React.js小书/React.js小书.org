# -*- eval: (setq org-download-image-dir (concat default-directory "/screenshotImg")); -*-
#+LATEX_CLASS: my-article
* React.js ç®€ä»‹
React.js æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ æ„å»ºé¡µé¢ UI çš„åº“. å¦‚æœä½ ç†Ÿæ‚‰ MVC æ¦‚å¿µçš„è¯, é‚£ä¹ˆ React çš„ç»„ä»¶å°±
ç›¸å½“äº MVC é‡Œé¢çš„ View. å¦‚æœä½ ä¸ç†Ÿæ‚‰ä¹Ÿæ²¡å…³ç³», ä½ å¯ä»¥ç®€å•åœ°ç†è§£ä¸º,React.js å°†å¸®åŠ©
æˆ‘ä»¬å°†ç•Œé¢åˆ†æˆäº†å„ä¸ªç‹¬ç«‹çš„å°å—, æ¯ä¸€ä¸ªå—å°±æ˜¯ç»„ä»¶, è¿™äº›ç»„ä»¶ä¹‹é—´å¯ä»¥ç»„åˆ, åµŒå¥—, å°±æˆ
äº†æˆ‘ä»¬çš„é¡µé¢.

ä¸€ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€å’Œè¡Œä¸ºæœ‰å¯èƒ½æ˜¯ç”±æŸäº›æ•°æ®å†³å®šçš„. è€Œæ•°æ®æ˜¯å¯èƒ½å‘ç”Ÿæ”¹å˜çš„, è¿™æ—¶å€™ç»„
ä»¶çš„æ˜¾ç¤ºå½¢æ€å°±ä¼šå‘ç”Ÿç›¸åº”çš„æ”¹å˜. è€Œ React.js ä¹Ÿæä¾›äº†ä¸€ç§éå¸¸é«˜æ•ˆçš„æ–¹å¼å¸®åŠ©æˆ‘ä»¬åšåˆ°
äº†æ•°æ®å’Œç»„ä»¶æ˜¾ç¤ºå½¢æ€ä¹‹é—´çš„åŒæ­¥.

React.js ä¸æ˜¯ä¸€ä¸ªæ¡†æ¶, å®ƒåªæ˜¯ä¸€ä¸ªåº“. å®ƒåªæä¾› UI(view) å±‚é¢çš„è§£å†³æ–¹æ¡ˆ. åœ¨å®é™…çš„é¡¹
ç›®å½“ä¸­, å®ƒå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬æ‰€æœ‰çš„é—®é¢˜, éœ€è¦ç»“åˆå…¶å®ƒçš„åº“, ä¾‹å¦‚ Redux,React-router ç­‰æ¥
ååŠ©æä¾›å®Œæ•´çš„è§£å†³æ–¹æ³•.

* å‰ç«¯ç»„ä»¶åŒ–(ä¸€): ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²èµ·
å¾ˆå¤šè¯¾ç¨‹ä¸€ä¸Šæ¥å°±ç»™å¤§å®¶å¦‚ä½•é…ç½®ç¯å¢ƒ, æ€ä¹ˆå†™ React.js ç»„ä»¶. ä½†æ˜¯æœ¬è¯¾ç¨‹è¿˜æ˜¯å¸Œæœ›å¤§å®¶å¯¹é—®é¢˜çš„æ ¹æºæœ‰ä¸€ä¸ªæ›´åŠ æ·±å…¥çš„äº†è§£, å…¶å®å¾ˆå¤šçš„åº“, æ¡†æ¶éƒ½æ˜¯è§£å†³ç±»ä¼¼çš„é—®é¢˜. åªæœ‰æˆ‘ä»¬å¯¹è¿™äº›åº“, æ¡†æ¶è§£å†³çš„é—®é¢˜æœ‰æ·±å…¥çš„äº†è§£å’Œæ€è€ƒä»¥å, æˆ‘ä»¬æ‰èƒ½å¾—å¿ƒåº”æ‰‹åœ°ä½¿ç”¨å®ƒä»¬, å¹¶ä¸”æœ‰æ–°çš„æ¡†æ¶å‡ºæ¥ä¹Ÿä¸ä¼šå¤ªè¿‡è¿·èŒ«â€”â€”â€”â€”å› ä¸ºå…¶å®å®ƒä»¬è§£å†³éƒ½æ˜¯åŒä¸€ä¸ªé—®é¢˜.

è¿™ä¸¤èŠ‚è¯¾æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹æ˜¯ä»€ä¹ˆæ ·çš„é—®é¢˜å¯¼è‡´äº†æˆ‘ä»¬éœ€è¦å‰ç«¯é¡µé¢è¿›è¡Œç»„ä»¶åŒ–, å‰ç«¯é¡µé¢çš„ç»„ä»¶åŒ–éœ€è¦è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜. åç»­è¯¾ç¨‹æˆ‘ä»¬å†æ¥çœ‹çœ‹ React.js æ˜¯æ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜çš„.

æ‰€ä»¥è¿™å‡ èŠ‚æ‰€è®²çš„å†…å®¹å°†å’Œ React.js çš„å†…å®¹æ²¡æœ‰å¤ªå¤§çš„å…³ç³», ä½†æ˜¯å¦‚æœä½ èƒ½é¡ºåˆ©äº†è§£è¿™å‡ èŠ‚çš„å†…å®¹, é‚£ä¹ˆåé¢é‚£äº›å¯¹æ–°æ‰‹æ¥è¯´å¾ˆå¤æ‚çš„æ¦‚å¿µå¯¹ä½ æ¥è¯´å°±æ˜¯éå¸¸è‡ªç„¶çš„äº‹.

** ä¸€ä¸ªç®€å•çš„ç‚¹èµåŠŸèƒ½
 æˆ‘ä»¬ä¼šä»ä¸€ä¸ªç®€å•çš„ç‚¹èµåŠŸèƒ½è®²èµ·. å‡è®¾ç°åœ¨æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªç‚¹èµ, å–æ¶ˆç‚¹èµçš„åŠŸèƒ½.

 [[file:screenshotImg/B7575C67-64F8-4A13-9C63-4D6805FA360D.png][file:screenshotImg/B7575C67-64F8-4A13-9C63-4D6805FA360D.png]]

 å¦‚æœä½ å¯¹å‰ç«¯ç¨å¾®æœ‰ä¸€ç‚¹äº†è§£, ä½ å°±é¡ºæ‰‹æ‹ˆæ¥:

 #+BEGIN_SRC html
 <body>
   <div class='wrapper'>
     <button class='like-btn'>
       <span class='like-text'>ç‚¹èµ</span>
       <span>ğŸ‘</span>
     </button>
   </div>
 </body>
 #+END_SRC

 ä¸ºäº†æ¨¡æ‹Ÿç°å®å½“ä¸­çš„å®é™…æƒ…å†µ, æ‰€ä»¥è¿™é‡Œç‰¹æ„æŠŠè¿™ä¸ª button é‡Œé¢çš„ HTML ç»“æ„æå¾—ç¨å¾®å¤æ‚ä¸€äº›. æœ‰äº†è¿™ä¸ª HTML ç»“æ„, ç°åœ¨å°±ç»™å®ƒåŠ å…¥ä¸€äº› JavaScript çš„è¡Œä¸º:

 #+BEGIN_SRC javascript
 const button = document.querySelector('.like-btn')
     const buttonText = button.querySelector('.like-text')
     let isLiked = false
     button.addEventListener('click', () => {
             isLiked = !isLiked
             if (isLiked) {
                 buttonText.innerHTML = 'å–æ¶ˆ'
             } else {
                 buttonText.innerHTML = 'ç‚¹èµ'
             }
         }, false)
 #+END_SRC

 åŠŸèƒ½å’Œå®ç°éƒ½å¾ˆç®€å•, æŒ‰é’®å·²ç»å¯ä»¥æä¾›ç‚¹èµå’Œå–æ¶ˆç‚¹èµçš„åŠŸèƒ½. è¿™æ—¶å€™ä½ çš„åŒäº‹è·‘è¿‡æ¥äº†, è¯´ä»–å¾ˆå–œæ¬¢ä½ çš„æŒ‰é’®, ä»–ä¹Ÿæƒ³ç”¨ä½ å†™çš„è¿™ä¸ªç‚¹èµåŠŸèƒ½. è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†, ä½ å°±ä¼šå‘ç°è¿™ç§å®ç°æ–¹å¼å¾ˆè‡´å‘½: ä½ çš„åŒäº‹è¦æŠŠæ•´ä¸ª button å’Œé‡Œé¢çš„ç»“æ„å¤åˆ¶è¿‡å», è¿˜æœ‰æ•´æ®µ JavaScript ä»£ç ä¹Ÿè¦å¤åˆ¶è¿‡å». è¿™æ ·çš„å®ç°æ–¹å¼æ²¡æœ‰ä»»ä½•å¯å¤ç”¨æ€§.

** ç»“æ„å¤ç”¨
 ç°åœ¨æˆ‘ä»¬æ¥é‡æ–°ç¼–å†™è¿™ä¸ªç‚¹èµåŠŸèƒ½, è®©å®ƒå…·å¤‡ä¸€å®šçš„å¯å¤ç”¨. è¿™æ¬¡æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç±», è¿™ä¸ªç±»æœ‰ render æ–¹æ³•, è¿™ä¸ªæ–¹æ³•é‡Œé¢ç›´æ¥è¿”å›ä¸€ä¸ªè¡¨ç¤º HTML ç»“æ„çš„å­—ç¬¦ä¸²:

 #+BEGIN_SRC javascript
 class LikeButton {
    render () {
        return `
         <button id='like-btn'>
           <span class='like-text'>èµ</span>
           <span>ğŸ‘</span>
         </button>
       `
    }
 }
 #+END_SRC

 ç„¶åå¯ä»¥ç”¨è¿™ä¸ªç±»æ¥æ„å»ºä¸åŒçš„ç‚¹èµåŠŸèƒ½çš„å®ä¾‹, ç„¶åæŠŠå®ƒä»¬æ’åˆ°é¡µé¢ä¸­.

 #+BEGIN_SRC javascript
 const wrapper = document.querySelector('.wrapper')
 const likeButton1 = new LikeButton()
 wrapper.innerHTML = likeButton1.render()

 const likeButton2 = new LikeButton()
 wrapper.innerHTML += likeButton2.render()
 #+END_SRC

 è¿™é‡Œéå¸¸æš´åŠ›åœ°ä½¿ç”¨äº† innerHTML , æŠŠä¸¤ä¸ªæŒ‰é’®ç²—é²åœ°æ’å…¥äº† wrapper å½“ä¸­. è™½ç„¶ä½ å¯èƒ½ä¼šå¯¹è¿™ç§å®ç°æ–¹å¼éå¸¸ä¸æ»¡æ„, ä½†æˆ‘ä»¬è¿˜æ˜¯å‹‰å¼ºäº†å®ç°äº†ç»“æ„çš„å¤ç”¨. æˆ‘ä»¬åé¢å†æ¥ä¼˜åŒ–å®ƒ.

** å®ç°ç®€å•çš„ç»„ä»¶åŒ–
 ä½ ä¸€å®šä¼šå‘ç°, ç°åœ¨çš„æŒ‰é’®æ˜¯æ­»çš„, ä½ ç‚¹å‡»å®ƒå®ƒæ ¹æœ¬ä¸ä¼šæœ‰ä»€ä¹ˆååº”. å› ä¸ºæ ¹æœ¬æ²¡æœ‰å¾€ä¸Šé¢æ·»åŠ äº‹ä»¶. ä½†æ˜¯é—®é¢˜æ¥äº†, LikeButton ç±»é‡Œé¢æ˜¯è™½ç„¶è¯´æœ‰ä¸€ä¸ª button, ä½†æ˜¯è¿™ç©æ„æ ¹æœ¬å°±æ˜¯åœ¨å­—ç¬¦ä¸²é‡Œé¢çš„. ä½ æ€ä¹ˆèƒ½å¾€ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œé¢æ·»åŠ äº‹ä»¶å‘¢?DOM äº‹ä»¶çš„ API åªæœ‰ DOM ç»“æ„æ‰èƒ½ç”¨.

 æˆ‘ä»¬éœ€è¦ DOM ç»“æ„, å‡†ç¡®åœ°æ¥è¯´: æˆ‘ä»¬éœ€è¦è¿™ä¸ªç‚¹èµåŠŸèƒ½çš„ HTML å­—ç¬¦ä¸²è¡¨ç¤ºçš„ DOM ç»“æ„. å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå‡½æ•° =createDOMFromString=, ä½ å¾€è¿™ä¸ªå‡½æ•°ä¼ å…¥ HTML å­—ç¬¦ä¸², ä½†æ˜¯å®ƒä¼šæŠŠç›¸åº”çš„ DOM å…ƒç´ è¿”å›ç»™ä½ . è¿™ä¸ªé—®é¢˜å°±å¯ä»¥è§£å†³äº†.

 #+CAPTION: createDOMFromString
 #+BEGIN_SRC javascript
 // ::String => ::Document
 const createDOMFromString = (domString) => {
     const div = document.createElement('div')
     div.innerHTML = domString
     return div
 }
 #+END_SRC
 <<createDOMFromString>>

 å…ˆä¸ç”¨ç®¡è¿™ä¸ªå‡½æ•°åº”è¯¥æ€ä¹ˆå®ç°, å…ˆçŸ¥é“å®ƒæ˜¯å¹²å˜›çš„. æ‹¿æ¥ç”¨å°±å¥½, è¿™æ—¶å€™ç”¨å®ƒæ¥æ”¹å†™ä¸€ä¸‹ LikeButton ç±»:

 #+CAPTION: render
 #+BEGIN_SRC javascript
 class LikeButton {
     render () {
         this.el = createDOMFromString(`
         <button class='like-button'>
           <span class='like-text'>ç‚¹èµ</span>
           <span>ğŸ‘</span>
         </button>
       `)
         this.el.addEventListener('click', () => console.log('click'), false)
         return this.el
     }
 }
 #+END_SRC
 <<render>>

 ç°åœ¨ render() è¿”å›çš„ä¸æ˜¯ä¸€ä¸ª html å­—ç¬¦ä¸²äº†, è€Œæ˜¯ä¸€ä¸ªç”±è¿™ä¸ª html å­—ç¬¦ä¸²æ‰€ç”Ÿæˆçš„ DOM. åœ¨è¿”å› DOM å…ƒç´ ä¹‹å‰ä¼šå…ˆç»™è¿™ä¸ª DOM å…ƒç´ ä¸Šæ·»åŠ äº‹ä»¶å†è¿”å›.

 å› ä¸ºç°åœ¨ render è¿”å›çš„æ˜¯ DOM å…ƒç´ , æ‰€ä»¥ä¸èƒ½ç”¨ innerHTML æš´åŠ›åœ°æ’å…¥ wrapper. è€Œæ˜¯è¦ç”¨ =DOM API= æ’è¿›å».

 #+BEGIN_SRC javascript :results valuse list
 const wrapper = document.querySelector('.wrapper')

 const likeButton1 = new LikeButton()
 wrapper.appendChild(likeButton1.render())

 const likeButton2 = new LikeButton()
 wrapper.appendChild(likeButton2.render())
 #+END_SRC

 ç°åœ¨ä½ ç‚¹å‡»è¿™ä¸¤ä¸ªæŒ‰é’®, æ¯ä¸ªæŒ‰é’®éƒ½ä¼šåœ¨æ§åˆ¶å°æ‰“å° click, è¯´æ˜äº‹ä»¶ç»‘å®šæˆåŠŸäº†. ä½†æ˜¯æŒ‰é’®ä¸Šçš„æ–‡æœ¬è¿˜æ˜¯æ²¡æœ‰å‘ç”Ÿæ”¹å˜, åªè¦ç¨å¾®æ”¹åŠ¨ä¸€ä¸‹ LikeButton çš„ä»£ç å°±å¯ä»¥å®Œæˆå®Œæ•´çš„åŠŸèƒ½:

 #+BEGIN_SRC javascript
 class LikeButton {
     constructor () {
         this.state = { isLiked: false }
     }

     changeLikeText () {
         const likeText = this.el.querySelector('.like-text')
         this.state.isLiked = !this.state.isLiked
         likeText.innerHTML = this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'
     }

     render () {
         this.el = createDOMFromString(`
         <button class='like-button'>
           <span class='like-text'>ç‚¹èµ</span>
           <span>ğŸ‘</span>
         </button>
       `)
         this.el.addEventListener('click', this.changeLikeText.bind(this), false)
         return this.el
     }
 }
 #+END_SRC

 è¿™é‡Œçš„ä»£ç ç¨å¾®é•¿äº†ä¸€äº›, ä½†æ˜¯è¿˜æ˜¯å¾ˆå¥½ç†è§£. åªä¸è¿‡æ˜¯åœ¨ç»™ LikeButton ç±»æ·»åŠ äº†æ„é€ å‡½æ•°, è¿™ä¸ªæ„é€ å‡½æ•°ä¼šç»™æ¯ä¸€ä¸ª LikeButton çš„å®ä¾‹æ·»åŠ ä¸€ä¸ªå¯¹è±¡ state,state é‡Œé¢ä¿å­˜äº†æ¯ä¸ªæŒ‰é’®è‡ªå·±æ˜¯å¦ç‚¹èµçš„çŠ¶æ€. è¿˜æ”¹å†™äº†åŸæ¥çš„äº‹ä»¶ç»‘å®šå‡½æ•°: åŸæ¥åªæ‰“å° click, ç°åœ¨ç‚¹å‡»çš„æŒ‰é’®çš„æ—¶å€™ä¼šè°ƒç”¨ changeLikeText æ–¹æ³•, è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® this.state çš„çŠ¶æ€æ”¹å˜ç‚¹èµæŒ‰é’®çš„æ–‡æœ¬.

 ç°åœ¨è¿™ä¸ªç»„ä»¶çš„å¯å¤ç”¨æ€§å·²ç»å¾ˆä¸é”™äº†, ä½ çš„åŒäº‹ä»¬åªè¦å®ä¾‹åŒ–ä¸€ä¸‹ç„¶åæ’å…¥åˆ° DOM é‡Œé¢å»å°±å¥½äº†.

 ä¸‹ä¸€èŠ‚æˆ‘ä»¬ç»§ç»­ä¼˜åŒ–è¿™ä¸ªä¾‹å­, è®©å®ƒæ›´åŠ é€šç”¨.

* å‰ç«¯ç»„ä»¶åŒ–(äºŒ): ä¼˜åŒ– DOM æ“ä½œ
çœ‹çœ‹ä¸Šä¸€èŠ‚æˆ‘ä»¬çš„ä»£ç , ä»”ç»†ç•™æ„ä¸€ä¸‹ changeLikeText å‡½æ•°, è¿™ä¸ªå‡½æ•°åŒ…å«äº† DOM æ“ä½œ, ç°åœ¨çœ‹èµ·æ¥æ¯”è¾ƒç®€å•, é‚£æ˜¯å› ä¸ºç°åœ¨åªæœ‰ isLiked ä¸€ä¸ªçŠ¶æ€. ç”±äºæ•°æ®çŠ¶æ€æ”¹å˜ä¼šå¯¼è‡´éœ€è¦æˆ‘ä»¬å»æ›´æ–°é¡µé¢çš„å†…å®¹, æ‰€ä»¥å‡æƒ³ä¸€ä¸‹, å¦‚æœä½ çš„ç»„ä»¶ä¾èµ–äº†å¾ˆå¤šçŠ¶æ€, é‚£ä¹ˆä½ çš„ç»„ä»¶åŸºæœ¬å…¨éƒ¨éƒ½æ˜¯ DOM æ“ä½œ.

ä¸€ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€ç”±å¤šä¸ªçŠ¶æ€å†³å®šçš„æƒ…å†µéå¸¸å¸¸è§. ä»£ç ä¸­æ··æ‚ç€å¯¹ DOM çš„æ“ä½œå…¶å®æ˜¯ä¸€ç§ä¸å¥½çš„å®è·µ, æ‰‹åŠ¨ç®¡ç†æ•°æ®å’Œ DOM ä¹‹é—´çš„å…³ç³»ä¼šå¯¼è‡´ä»£ç å¯ç»´æŠ¤æ€§å˜å·®, å®¹æ˜“å‡ºé”™. æ‰€ä»¥æˆ‘ä»¬çš„ä¾‹å­è¿™é‡Œè¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´: å¦‚ä½•å°½é‡å‡å°‘è¿™ç§æ‰‹åŠ¨ DOM æ“ä½œ?

** çŠ¶æ€æ”¹å˜ -> æ„å»ºæ–°çš„ DOM å…ƒç´ æ›´æ–°é¡µé¢
 è¿™é‡Œè¦æå‡ºçš„ä¸€ç§è§£å†³æ–¹æ¡ˆ: ä¸€æ—¦çŠ¶æ€å‘ç”Ÿæ”¹å˜, å°±é‡æ–°è°ƒç”¨ render æ–¹æ³•, æ„å»ºä¸€ä¸ªæ–°çš„ DOM å…ƒç´ . è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢? å¥½å¤„å°±æ˜¯ä½ å¯ä»¥åœ¨ render æ–¹æ³•é‡Œé¢ä½¿ç”¨æœ€æ–°çš„ this.state æ¥æ„é€ ä¸åŒ HTML ç»“æ„çš„å­—ç¬¦ä¸², å¹¶ä¸”é€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²æ„é€ ä¸åŒçš„ DOM å…ƒç´ . é¡µé¢å°±æ›´æ–°äº†! å¬èµ·æ¥æœ‰ç‚¹ç»•, çœ‹çœ‹ä»£ç æ€ä¹ˆå†™, ä¿®æ”¹åŸæ¥çš„ä»£ç ä¸º:

 #+BEGIN_SRC javascript
 class LikeButton {
     constructor () {
         this.state = { isLiked: false }
     }

     setState (state) {
         this.state = state
         this.el = this.render()
     }

     changeLikeText () {
         this.setState({
             isLiked: !this.state.isLiked
         })
     }

     render () {
         this.el = createDOMFromString(`
         <button class='like-btn'>
           <span class='like-text'>${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}</span>
           <span>ğŸ‘</span>
         </button>
       `)
         this.el.addEventListener('click', this.changeLikeText.bind(this), false)
         return this.el
     }
 }
 #+END_SRC
 [[createDOMFromString][See createDOMFromString]]

 å…¶å®åªæ˜¯æ”¹äº†å‡ ä¸ªå°åœ°æ–¹:
 render å‡½æ•°é‡Œé¢çš„ HTML å­—ç¬¦ä¸²ä¼šæ ¹æ® this.state ä¸åŒè€Œä¸åŒ(è¿™é‡Œæ˜¯ç”¨äº† ES6 çš„æ¨¡ç‰ˆå­—ç¬¦ä¸², åšè¿™ç§äº‹æƒ…å¾ˆæ–¹ä¾¿).
 æ–°å¢ä¸€ä¸ª =setState= å‡½æ•°, è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°, å®ƒä¼šè®¾ç½®å®ä¾‹çš„ state, ç„¶åé‡æ–°è°ƒç”¨ä¸€ä¸‹ render æ–¹æ³•.
 å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™, =changeLikeText= ä¼šæ„å»ºæ–°çš„ state å¯¹è±¡, è¿™ä¸ªæ–°çš„ state, ä¼ å…¥ setState å‡½æ•°å½“ä¸­.
 è¿™æ ·çš„ç»“æœå°±æ˜¯, ç”¨æˆ·æ¯æ¬¡ç‚¹å‡», =changeLikeText= éƒ½ä¼šè°ƒç”¨æ”¹å˜ç»„ä»¶çŠ¶æ€ç„¶åè°ƒç”¨ setState,setState ä¼šè°ƒç”¨ render,render æ–¹æ³•ä¼šæ ¹æ® state çš„ä¸åŒé‡æ–°æ„å»ºä¸åŒçš„ DOM å…ƒç´ .

 ä¹Ÿå°±æ˜¯è¯´, ä½ åªè¦è°ƒç”¨ setState, ç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“. æˆ‘ä»¬é¡ºåˆ©åœ°æ¶ˆé™¤äº†æ‰‹åŠ¨çš„ DOM æ“ä½œ.

** é‡æ–°æ’å…¥æ–°çš„ DOM å…ƒç´ 
 ä¸Šé¢çš„æ”¹è¿›ä¸ä¼šæœ‰ä»€ä¹ˆæ•ˆæœ, å› ä¸ºä½ ä»”ç»†çœ‹ä¸€ä¸‹å°±ä¼šå‘ç°, å…¶å®é‡æ–°æ¸²æŸ“çš„ DOM å…ƒç´ å¹¶æ²¡æœ‰æ’å…¥åˆ°é¡µé¢å½“ä¸­. æ‰€ä»¥åœ¨è¿™ä¸ªç»„ä»¶å¤–é¢, ä½ éœ€è¦çŸ¥é“è¿™ä¸ªç»„ä»¶å‘ç”Ÿäº†æ”¹å˜, å¹¶ä¸”æŠŠæ–°çš„ DOM å…ƒç´ æ›´æ–°åˆ°é¡µé¢å½“ä¸­.

 é‡æ–°ä¿®æ”¹ä¸€ä¸‹ =setState= æ–¹æ³•:

 #+CAPTION: setState
 #+BEGIN_SRC javascript
 ...
     setState (state) {
         const oldEl = this.el
         this.state = state
         this.el = this.render()
         if (this.onStateChange) this.onStateChange(oldEl, this.el)
     }
 ...
 #+END_SRC
 <<setState>>

 ä½¿ç”¨è¿™ä¸ªç»„ä»¶çš„æ—¶å€™:

 #+BEGIN_SRC javascript
 const likeButton = new LikeButton()
 wrapper.appendChild(likeButton.render()) // ç¬¬ä¸€æ¬¡æ’å…¥ DOM å…ƒç´ 
 likeButton.onStateChange = (oldEl, newEl) => {
     wrapper.insertBefore(newEl, oldEl) // æ’å…¥æ–°çš„å…ƒç´ 
     wrapper.removeChild(oldEl) // åˆ é™¤æ—§çš„å…ƒç´ 
 }
 #+END_SRC
 <<onStateChange>>

 è¿™é‡Œæ¯æ¬¡ =setState= éƒ½ä¼šè°ƒç”¨ =onStateChange= æ–¹æ³•, è€Œè¿™ä¸ªæ–¹æ³•æ˜¯å®ä¾‹åŒ–ä»¥åæ—¶å€™è¢«è®¾ç½®çš„, æ‰€ä»¥ä½ å¯ä»¥è‡ªå®šä¹‰ =onStateChange= çš„è¡Œä¸º. è¿™é‡Œåšçš„äº‹æ˜¯, æ¯å½“ =setState= ä¸­æ„é€ å®Œæ–°çš„ DOM å…ƒç´ ä»¥å, å°±ä¼šé€šè¿‡ =onStateChange= å‘ŠçŸ¥å¤–éƒ¨æ’å…¥æ–°çš„ DOM å…ƒç´ , ç„¶ååˆ é™¤æ—§çš„å…ƒç´ , é¡µé¢å°±æ›´æ–°äº†.
 è¿™é‡Œå·²ç»åšåˆ°äº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–äº†: ç°åœ¨ä¸éœ€è¦å†æ‰‹åŠ¨æ›´æ–°é¡µé¢äº†.

 éä¸€èˆ¬çš„æš´åŠ›, å› ä¸ºæ¯æ¬¡ =setState= éƒ½é‡æ–°æ„é€ , æ–°å¢, åˆ é™¤ DOM å…ƒç´ , ä¼šå¯¼è‡´æµè§ˆå™¨è¿›è¡Œå¤§é‡çš„é‡æ’, ä¸¥é‡å½±å“æ€§èƒ½. ä¸è¿‡æ²¡æœ‰å…³ç³», è¿™ç§æš´åŠ›è¡Œä¸ºå¯ä»¥è¢«ä¸€ç§å« =Virtual-DOM= çš„ç­–ç•¥è§„é¿æ‰, ä½†è¿™ä¸æ˜¯æœ¬æ–‡æ‰€è®¨è®ºçš„èŒƒå›´.

 è¿™ä¸ªç‰ˆæœ¬çš„ç‚¹èµåŠŸèƒ½å¾ˆä¸é”™, æˆ‘å¯ä»¥ç»§ç»­å¾€ä¸Šé¢åŠ åŠŸèƒ½, è€Œä¸”è¿˜ä¸éœ€è¦æ‰‹åŠ¨æ“ä½œ DOM. ä½†æ˜¯æœ‰ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹, å¦‚æœæˆ‘è¦é‡æ–°å¦å¤–åšä¸€ä¸ªæ–°ç»„ä»¶, è­¬å¦‚è¯´è¯„è®ºç»„ä»¶, é‚£ä¹ˆé‡Œé¢çš„è¿™äº› =setState= æ–¹æ³•è¦é‡æ–°å†™ä¸€é, å…¶å®è¿™äº›ä¸œè¥¿éƒ½å¯ä»¥æŠ½å‡ºæ¥, å˜æˆä¸€ä¸ªé€šç”¨çš„æ¨¡å¼. ä¸‹ä¸€èŠ‚æˆ‘ä»¬æŠŠè¿™ä¸ªé€šç”¨æ¨¡å¼æŠ½ç¦»åˆ°ä¸€ä¸ªç±»å½“ä¸­.

* å‰ç«¯ç»„ä»¶åŒ–(ä¸‰): æŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»
ä¸ºäº†è®©ä»£ç æ›´çµæ´», å¯ä»¥å†™æ›´å¤šçš„ç»„ä»¶, æˆ‘ä»¬æŠŠè¿™ç§æ¨¡å¼æŠ½è±¡å‡ºæ¥, æ”¾åˆ°ä¸€ä¸ª Component ç±»å½“ä¸­:

#+CAPTION: _renderDOM
#+BEGIN_SRC javascript
class Component {
    setState (state) {
        const oldEl = this.el
        this.state = state
        this._renderDOM()
        if (this.onStateChange) this.onStateChange(oldEl, this.el)
    }

    _renderDOM () {
        this.el = createDOMFromString(this.render())
        if (this.onClick) {
            this.el.addEventListener('click', this.onClick.bind(this), false)
        }
        return this.el
    }
}
#+END_SRC
<<_renderDOM>>
[[createDOMFromString][
See createDOMFromString]]

[[%E8%BF%94%E5%9B%9E%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84 render %E6%96%B9%E6%B3%95][See è¿”å›å­—ç¬¦ä¸²çš„ render æ–¹æ³•]]

[[setState][See setState]]

è¿™ä¸ªæ˜¯ä¸€ä¸ªç»„ä»¶çˆ¶ç±» Component, æ‰€æœ‰çš„ç»„ä»¶éƒ½å¯ä»¥ç»§æ‰¿è¿™ä¸ªçˆ¶ç±»æ¥æ„å»º. å®ƒå®šä¹‰çš„ä¸¤ä¸ªæ–¹æ³•, ä¸€ä¸ªæ˜¯æˆ‘ä»¬å·²ç»å¾ˆç†Ÿæ‚‰çš„ setState, ä¸€ä¸ªæ˜¯ç§æœ‰æ–¹æ³• =_renderDOM=.
=_renderDOM= æ–¹æ³•ä¼šè°ƒç”¨ this.render æ¥æ„å»º DOM å…ƒç´ å¹¶ä¸”ç›‘å¬ onClick äº‹ä»¶.
=æ‰€ä»¥, ç»„ä»¶å­ç±»ç»§æ‰¿çš„æ—¶å€™åªéœ€è¦å®ç°ä¸€ä¸ªè¿”å› HTML å­—ç¬¦ä¸²çš„ render æ–¹æ³•å°±å¯ä»¥äº†.=

è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ =mount= çš„æ–¹æ³•, å…¶å®å°±æ˜¯æŠŠç»„ä»¶çš„ DOM å…ƒç´ æ’å…¥é¡µé¢, å¹¶ä¸”åœ¨ setState çš„æ—¶å€™æ›´æ–°é¡µé¢:

#+CAPTION: mount
#+BEGIN_SRC javascript
const mount = (component, wrapper) => {
    wrapper.appendChild(component._renderDOM())
    component.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl)
        wrapper.removeChild(oldEl)
    }
}
#+END_SRC
<<mount>>

[[onStateChange][See onStateChange]]

è¿™æ ·çš„è¯æˆ‘ä»¬é‡æ–°å†™ç‚¹èµç»„ä»¶å°±ä¼šå˜æˆ:

#+CAPTION: è¿”å›å­—ç¬¦ä¸²çš„ render æ–¹æ³•
#+BEGIN_SRC javascript
class LikeButton extends Component {
    constructor () {
        super()
        this.state = { isLiked: false }
    }

    onClick () {
        this.setState({
            isLiked: !this.state.isLiked
        })
    }

    render () {
        return `
        <button class='like-btn'>
          <span class='like-text'>${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}</span>
          <span>ğŸ‘</span>
        </button>
      `
    }
}

mount(new LikeButton(), wrapper)
#+END_SRC
<<è¿”å›å­—ç¬¦ä¸²çš„ render æ–¹æ³•>>

[[_renderDOM][See _renderDOM]]

è¿™æ ·è¿˜ä¸å¤Ÿå¥½. åœ¨å®é™…å¼€å‘å½“ä¸­, ä½ å¯èƒ½éœ€è¦ç»™ç»„ä»¶ä¼ å…¥ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®æ•°æ®. ä¾‹å¦‚è¯´æƒ³é…ç½®ä¸€ä¸‹ç‚¹èµæŒ‰é’®çš„èƒŒæ™¯é¢œè‰², å¦‚æœæˆ‘ç»™å®ƒä¼ å…¥ä¸€ä¸ªå‚æ•°, å‘Šè¯‰å®ƒæ€ä¹ˆè®¾ç½®è‡ªå·±çš„é¢œè‰². é‚£ä¹ˆè¿™ä¸ªæŒ‰é’®çš„å®šåˆ¶æ€§å°±æ›´å¼ºäº†. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™ç»„ä»¶ç±»å’Œå®ƒçš„å­ç±»éƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•° props, ä½œä¸ºç»„ä»¶çš„é…ç½®å‚æ•°. ä¿®æ”¹ Component çš„æ„é€ å‡½æ•°ä¸º:

#+BEGIN_SRC javascript
...
    constructor (props = {}) {
        this.props = props
    }
...
#+END_SRC

ç»§æ‰¿çš„æ—¶å€™é€šè¿‡ super(props) æŠŠ props ä¼ ç»™çˆ¶ç±», è¿™æ ·å°±å¯ä»¥é€šè¿‡ this.props è·å–åˆ°é…ç½®å‚æ•°:

#+CAPTION: æ”¯æŒè¯»å– props å‚æ•°çš„ render æ–¹æ³•
#+BEGIN_SRC javascript
class LikeButton extends Component {
    constructor (props) {
        super(props)
        this.state = { isLiked: false }
    }

    onClick () {
        this.setState({
            isLiked: !this.state.isLiked
        })
    }

    render () {
        return `
        <button class='like-btn' style="background-color: ${this.props.bgColor}">
          <span class='like-text'>
            ${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}
          </span>
          <span>ğŸ‘</span>
        </button>
      `
    }
}

mount(new LikeButton({ bgColor: 'red' }), wrapper)
#+END_SRC
<<æ”¯æŒè¯»å– props å‚æ•°çš„ render æ–¹æ³•>>

è¿™é‡Œæˆ‘ä»¬ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹åŸæœ‰çš„ LikeButton çš„ =render= æ–¹æ³•, è®©å®ƒå¯ä»¥æ ¹æ®ä¼ å…¥çš„å‚æ•° =this.props.bgColor= æ¥ç”Ÿæˆä¸åŒçš„ style å±æ€§. è¿™æ ·å°±å¯ä»¥è‡ªç”±é…ç½®ç»„ä»¶çš„é¢œè‰²äº†.

åªè¦æœ‰äº†ä¸Šé¢é‚£ä¸ª =Component= ç±»å’Œ =mount= [[mount][See mount ]] æ–¹æ³•åŠ èµ·æ¥ä¸è¶³ 40 è¡Œä»£ç å°±å¯ä»¥åšåˆ°ç»„ä»¶åŒ–. å¦‚æœæˆ‘ä»¬éœ€è¦å†™å¦å¤–ä¸€ä¸ªç»„ä»¶, åªéœ€è¦åƒä¸Šé¢é‚£æ ·, ç®€å•åœ°ç»§æ‰¿ä¸€ä¸‹ Component ç±»å°±å¥½äº†:

#+BEGIN_SRC javascript
class RedBlueButton extends Component {
    constructor (props) {
        super(props)
        this.state = {
            color: 'red'
        }
    }

    onClick () {
        this.setState({
            color: 'blue'
        })
    }

    render () {
        return `
        <div style='color: ${this.state.color};'>${this.state.color}</div>
      `
    }
}
#+END_SRC

ç®€å•å¥½ç”¨, ç°åœ¨å¯ä»¥çµæ´»åœ°ç»„ä»¶åŒ–é¡µé¢äº†.Component å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°.

#+CAPTION: reactjs-in-40
#+BEGIN_SRC javascript
<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>Reactjs in 40 </title>
    <style media="screen">
      .like-btn { font-size: 50px; }
    </style>
  </head>

  <body>
    <div class='wrapper'></div>
  </body>

  <script type="text/javascript">
    /* Component */
    class Component {
      constructor (props = {}) {
        this.props = props
      }
      setState (state) {
        const oldEl = this.el
        this.state = state
        this.el = this.renderDOM()
        if (this.onStateChange) this.onStateChange(oldEl, this.el)
      }
      renderDOM () {
        this.el = createDOMFromString(this.render())
        if (this.onClick) {
          this.el.addEventListener('click', this.onClick.bind(this), false)
        }
        return this.el
      }
    }
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }
    const mount = (component, wrapper) => {
      wrapper.appendChild(component.renderDOM())
      component.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl)
        wrapper.removeChild(oldEl)
      }
    }
    /* ========================================= */
    class LikeButton extends Component {
      constructor (props) {
        super(props)
        this.state = { isLiked: false }
      }
      onClick () {
        this.setState({
          isLiked: !this.state.isLiked
        })
      }
      render () {
        return `
          <button class='like-btn' style="background-color: ${this.props.bgColor}">
            <span class='like-text'>
              ${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}
            </span>
            <span>ğŸ‘</span>
          </button>
        `
      }
    }
    class RedBlueButton extends Component {
      constructor (props) {
        super(props)
        this.state = {
          color: 'red'
        }
      }
      onClick () {
        this.setState({
          color: 'blue'
        })
      }
      render () {
        return `
          <div style='color: ${this.state.color};'>${this.state.color}</div>
        `
      }
    }
    const wrapper = document.querySelector('.wrapper')
    mount(new LikeButton({ bgColor: 'red' }), wrapper)
    mount(new LikeButton(), wrapper)
    mount(new RedBlueButton(), wrapper)
  </script>
</html>
#+END_SRC
<<reactjs-in-40>>

** æ€»ç»“
 æˆ‘ä»¬ç”¨äº†å¾ˆé•¿çš„ç¯‡å¹…æ¥è®²ä¸€ä¸ªç®€å•çš„ç‚¹èµçš„ä¾‹å­, å¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œé¢ä¸€ç›´åœ¨ä¼˜åŒ–ç¼–å†™çš„æ–¹å¼. æœ€åæŠ½ç¦»å‡ºæ¥äº†ä¸€ä¸ªç±», å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„åšç»„ä»¶åŒ–. åœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œé¢æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆ?

 ç»„ä»¶åŒ–å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³å‰ç«¯ç»“æ„çš„å¤ç”¨æ€§é—®é¢˜, æ•´ä¸ªé¡µé¢å¯ä»¥ç”±è¿™æ ·çš„ä¸åŒçš„ç»„ä»¶ç»„åˆ, åµŒå¥—æ„æˆ.

 ä¸€ä¸ªç»„ä»¶æœ‰è‡ªå·±çš„æ˜¾ç¤ºå½¢æ€(ä¸Šé¢çš„ HTML ç»“æ„å’Œå†…å®¹) è¡Œä¸º, ç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€å’Œè¡Œä¸ºå¯ä»¥ç”±æ•°æ®çŠ¶æ€(state) å’Œé…ç½®å‚æ•°(props) å…±åŒå†³å®š. æ•°æ®çŠ¶æ€å’Œé…ç½®å‚æ•°çš„æ”¹å˜éƒ½ä¼šå½±å“åˆ°è¿™ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€.

 å½“æ•°æ®å˜åŒ–çš„æ—¶å€™, ç»„ä»¶çš„æ˜¾ç¤ºéœ€è¦æ›´æ–°. æ‰€ä»¥å¦‚æœç»„ä»¶åŒ–çš„æ¨¡å¼èƒ½æä¾›ä¸€ç§é«˜æ•ˆçš„æ–¹å¼è‡ªåŠ¨åŒ–åœ°å¸®åŠ©æˆ‘ä»¬æ›´æ–°é¡µé¢, é‚£ä¹Ÿå°±å¯ä»¥å¤§å¤§åœ°é™ä½æˆ‘ä»¬ä»£ç çš„å¤æ‚åº¦, å¸¦æ¥æ›´å¥½çš„å¯ç»´æŠ¤æ€§.

 å¥½äº†, è¯¾ç¨‹ç»“æŸäº†. ä½ å·²ç»å­¦ä¼šäº†æ€ä¹ˆä½¿ç”¨ React.js äº†, å› ä¸ºæˆ‘ä»¬å·²ç»å†™äº†ä¸€ä¸ªâ€”â€”å½“ç„¶æˆ‘æ˜¯åœ¨å¼€ç©ç¬‘, ä½†æ˜¯ä¸Šé¢è¿™ä¸ª Component ç±»å…¶å®å’Œ React çš„ Component ä½¿ç”¨æ–¹å¼å¾ˆç±»ä¼¼. æŒæ¡äº†è¿™å‡ èŠ‚çš„è¯¾ç¨‹, ä½ åŸºæœ¬å°±æŒæ¡äº†åŸºç¡€çš„ React.js çš„æ¦‚å¿µ.

 æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹æ­£å¼è¿›å…¥ä¸»é¢˜, å¼€å§‹æ­£å¼ä»‹ç» React.js. ä½ ä¼šå‘ç°, æœ‰äº†å‰é¢çš„é“ºå«, ä¸‹é¢è®²çš„å†…å®¹ç†è§£èµ·æ¥ä¼šç®€å•å¾ˆå¤šäº†.
* React.js åŸºæœ¬ç¯å¢ƒå®‰è£…
** å®‰è£… React.js
 React.js å•ç‹¬ä½¿ç”¨åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„äº‹æƒ…. ä¸è¦æŒ‡æœ›ç€ç±»ä¼¼äº jQuery ä¸‹è½½æ”¾åˆ° <head/> æ ‡ç­¾å°±å¼€å§‹ä½¿ç”¨. ä½¿ç”¨ React.js ä¸ç®¡åœ¨å¼€å‘é˜¶æ®µç”Ÿäº§é˜¶æ®µéƒ½éœ€è¦ä¸€å †å·¥å…·å’Œåº“è¾…åŠ©, ç¼–è¯‘é˜¶æ®µä½ éœ€è¦å€ŸåŠ© Babel, éœ€è¦ Redux ç­‰ç¬¬ä¸‰æ–¹çš„çŠ¶æ€ç®¡ç†å·¥å…·æ¥ç»„ç»‡ä»£ç , å¦‚æœä½ è¦å†™å•é¡µé¢åº”ç”¨é‚£ä¹ˆä½ éœ€è¦ React-router. è¿™å°±æ˜¯æ‰€è°“çš„"React.js å…¨å®¶æ¡¶".

 æœ¬è¯¾ç¨‹ä¸ä¼šæ•™å¤§å®¶å¦‚ä½•é…ç½®è¿™äº›ä¸œè¥¿, å› ä¸ºè¿™ä¸æ˜¯è¯¾ç¨‹çš„é‡ç‚¹, ç½‘ä¸Šæœ‰å¾ˆå¤šçš„èµ„æ–™, å¤§å®¶å¯ä»¥å»å‚è€ƒé‚£äº›èµ„æ–™. æˆ‘ä»¬è¿™é‡Œä¼šç›´æ¥ä½¿ç”¨ React.js å®˜ç½‘æ‰€æ¨èä½¿ç”¨çš„å·¥å…· create-react-app å·¥å…·. å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¸€é”®ç”Ÿæˆæ‰€éœ€è¦çš„å·¥ç¨‹ç›®å½•, å¹¶å¸®æˆ‘ä»¬åšå¥½å„ç§é…ç½®å’Œä¾èµ–, ä¹Ÿå¸®æˆ‘ä»¬éšè—äº†è¿™äº›é…ç½®çš„ç»†èŠ‚. ä¹Ÿå°±æ˜¯æ‰€è°“çš„" å¼€ç®±å³ç”¨".

 å·¥å…·åœ°å€:https://github.com/facebookincubator/create-react-app

 [[file:screenshotImg/C9754D1A-0989-49B2-AC9F-B8D9717198CB.png]]

 åœ¨å®‰è£…ä¹‹å‰è¦ç¡®è®¤ä½ çš„æœºå™¨ä¸Šå®‰è£…äº† node.js ç¯å¢ƒåŒ…æ‹¬ npm. å¦‚æœæ²¡æœ‰å®‰è£…çš„åŒå­¦å¯ä»¥åˆ° node.js çš„å®˜ç½‘ä¸‹è½½è‡ªå·±ç”µè„‘çš„å¯¹åº”çš„å®‰è£…åŒ…æ¥å®‰è£…å¥½ç¯å¢ƒ.

 å®‰è£…å¥½ç¯å¢ƒä»¥å, åªéœ€è¦æŒ‰ç…§å®˜ç½‘çš„æŒ‡å¼•å®‰è£… create-react-app å³å¯.


 #+BEGIN_SRC javascript :results valuse list :exports both
 npm install -g create-react-app
 #+END_SRC

 è¿™æ¡å‘½ä»¤ä¼šå¾€æˆ‘ä»¬çš„æœºå™¨ä¸Šå®‰è£…ä¸€æ¡å« =create-react-app= çš„å‘½ä»¤, å®‰è£…å¥½ä»¥åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒæ¥æ„å»ºä¸€ä¸ª react çš„å‰ç«¯å·¥ç¨‹:

 #+BEGIN_SRC javascript :results valuse list :exports both
 create-react-app hello-react
 #+END_SRC

 è¿™æ¡å‘½ä»¤ä¼šå¸®æˆ‘ä»¬æ„å»ºä¸€ä¸ªå« hello-react çš„å·¥ç¨‹, å¹¶ä¸”ä¼šè‡ªåŠ¨åœ°å¸®åŠ©æˆ‘ä»¬å®‰è£…æ‰€éœ€è¦çš„ä¾èµ–, ç°åœ¨åªéœ€è¦å®‰é™åœ°ç­‰å¾…å®ƒå®‰è£…å®Œ.

 #+BEGIN_QUOTE
 é¢å¤–çš„å°è´´å£«:

 å¦‚æœæœ‰äº›åŒå­¦å®‰è£…è¿‡ç¨‹æ¯”è¾ƒæ…¢, é‚£æ˜¯å¾ˆæœ‰å¯èƒ½æ˜¯å› ä¸º npm ä¸‹è½½çš„æ—¶å€™æ˜¯ä»å›½å¤–çš„æºä¸‹è½½çš„ç¼˜æ•…. æ‰€ä»¥å¯ä»¥æŠŠ npm çš„æºæ”¹æˆå›½å†…çš„ taobao çš„æº, è¿™æ ·ä¼šåŠ é€Ÿä¸‹è½½è¿‡ç¨‹. åœ¨æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹å‰å¯ä»¥å…ˆä¿®æ”¹ä¸€ä¸‹ npm çš„æº:

 #+BEGIN_SRC javascript :results valuse list :exports both
 npm config set registry https://registry.npm.taobao.org
 #+END_SRC

 #+END_QUOTE

 ä¸‹è½½å®Œä»¥åæˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨å·¥ç¨‹äº†, è¿›å…¥å·¥ç¨‹ç›®å½•ç„¶åé€šè¿‡ npm å¯åŠ¨å·¥ç¨‹:

 #+BEGIN_SRC javascript :results valuse list :exports both
 cd hello-react
 npm start
 #+END_SRC

 ç»ˆç«¯æç¤ºæˆåŠŸ:

 [[file:screenshotImg/C9754D1A-0989-49B2-AC9F-B8D9717198CB.png]]

 å¹¶ä¸”ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨, å°±å¯ä»¥çœ‹åˆ° React çš„å·¥ç¨‹é¡ºåˆ©è¿è¡Œçš„æ•ˆæœ:

 [[file:screenshotImg/React_App.png]]

 è¿™æ—¶å€™æˆ‘ä»¬æŠŠ src/App.js æ–‡ä»¶ä¸­çš„ <h2> æ ‡ç­¾çš„å†…å®¹ä¿®æ”¹ä¸º Hello React,

 #+BEGIN_SRC javascript :results valuse list :exports both
     <h2>Hello React</h2>
 #+END_SRC

 ä¿å­˜ä¸€ä¸‹, ç„¶åæˆ·å°±ä¼šå‘ç°æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°, å¹¶ä¸”æˆ‘ä»¬çš„ä¿®æ”¹ä¹Ÿç”Ÿæ•ˆäº†:

 [[file:screenshotImg/3FDC1B75-AACD-40A4-9101-1AF8C57EFBF4.png]]

 åˆ°è¿™é‡Œæˆ‘ä»¬çš„ç¯å¢ƒå·²ç»å®‰è£…å¥½äº†, å¹¶ä¸”é¡ºåˆ©åœ°è¿è¡Œäº†æˆ‘ä»¬ç¬¬ä¸€ä¸ªä¾‹å­. æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šæ¢è®¨ React.js çš„ç»„ä»¶çš„åŸºæœ¬å†™æ³•.
* ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯
è¿™ä¸€èŠ‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²è§£ React.js æè¿°é¡µé¢ UI çš„æ–¹å¼. æŠŠ src/index.js ä¸­çš„ä»£ç æ”¹æˆ:
#+BEGIN_SRC javascript :results valuse list :exports both
import React, { Component } from 'react'
import ReactDOM from 'react-dom'
import './index.css'

class Header extends Component {
   render () {
       return (
               <div>
                 <h1>React å°ä¹¦</h1>
               </div>
       )
   }
}

ReactDOM.render(
   <Header />,
   document.getElementById('root')
)
#+END_SRC

æˆ‘ä»¬åœ¨æ–‡ä»¶å¤´éƒ¨ä» react çš„åŒ…å½“ä¸­å¼•å…¥äº† React å’Œ React.js çš„ç»„ä»¶çˆ¶ç±» Component. è®°ä½, åªè¦ä½ è¦å†™ React.js ç»„ä»¶, é‚£ä¹ˆå°±å¿…é¡»è¦å¼•å…¥è¿™ä¸¤ä¸ªä¸œè¥¿.

ReactDOM å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠ React ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Šå», æ²¡æœ‰å…¶å®ƒçš„ä½œç”¨äº†. ä½ å¯ä»¥å‘ç°å®ƒæ˜¯ä» react-dom ä¸­å¼•å…¥çš„, è€Œä¸æ˜¯ä» react å¼•å…¥. æœ‰äº›æœ‹å‹å¯èƒ½ä¼šç–‘æƒ‘, ä¸ºä»€ä¹ˆä¸æŠŠè¿™äº›ä¸œè¥¿éƒ½åŒ…å«åœ¨ react åŒ…å½“ä¸­å‘¢? æˆ‘ä»¬ç¨åä¼šå›ç­”è¿™ä¸ªé—®é¢˜.

æ¥ä¸‹æ¥çš„ä»£ç ä½ çœ‹èµ·æ¥ä¼šæ¯”è¾ƒç†Ÿæ‚‰, ä½†åˆä¼šæœ‰ç‚¹é™Œç”Ÿ. ä½ çœ‹å…¶å®å®ƒè·Ÿæˆ‘ä»¬å‰å‡ èŠ‚é‡Œé¢è®²çš„å†…å®¹å…¶å®å¾ˆç±»ä¼¼, ä¸€ä¸ªç»„ä»¶ç»§æ‰¿ Component ç±», æœ‰ä¸€ä¸ª render æ–¹æ³•, å¹¶ä¸”æŠŠè¿™ä¸ªç»„ä»¶çš„ HTML ç»“æ„è¿”å›, è¿™é‡Œ return çš„ä¸œè¥¿å°±æ¯”è¾ƒå¥‡æ€ªäº†, å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², çœ‹èµ·æ¥åƒæ˜¯çº¯ HTML ä»£ç å†™åœ¨ JavaScript ä»£ç é‡Œé¢. ä½ ä¹Ÿè®¸ä¼šè¯´, è¿™ä¸å°±æœ‰è¯­æ³•é”™è¯¯äº†ä¹ˆ? è¿™å®Œå…¨ä¸æ˜¯åˆæ³•çš„ JavaScript ä»£ç . è¿™ç§çœ‹èµ·æ¥" åœ¨ JavaScript å†™çš„æ ‡ç­¾çš„" è¯­æ³•å« JSX.

** JSX åŸç†
 ä¸ºäº†è®©å¤§å®¶æ·±åˆ»ç†è§£ JSX çš„å«ä¹‰. æœ‰å¿…è¦ç®€å•ä»‹ç»äº†ä¸€ä¸‹ JSX ç¨å¾®åº•å±‚çš„è¿ä½œåŸç†, è¿™æ ·å¤§å®¶å¯ä»¥æ›´åŠ æ·±åˆ»ç†è§£ JSX åˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿, ä¸ºä»€ä¹ˆè¦æœ‰è¿™ç§è¯­æ³•, å®ƒæ˜¯ç»è¿‡æ€ä¹ˆæ ·çš„è½¬åŒ–å˜æˆé¡µé¢çš„å…ƒç´ çš„.

 æ€è€ƒä¸€ä¸ªé—®é¢˜: å¦‚ä½•ç”¨ JavaScript å¯¹è±¡æ¥è¡¨ç°ä¸€ä¸ª DOM å…ƒç´ çš„ç»“æ„, ä¸¾ä¸ªä¾‹å­:

 #+BEGIN_SRC javascript :results valuse list :exports both
 <div class='box' id='content'>
 <div class='title'>Hello</div>
 <button>Click</button>
 </div>
 #+END_SRC

 æ¯ä¸ª DOM å…ƒç´ çš„ç»“æ„éƒ½å¯ä»¥ç”¨ JavaScript çš„å¯¹è±¡æ¥è¡¨ç¤º. ä½ ä¼šå‘ç°ä¸€ä¸ª DOM å…ƒç´ åŒ…å«çš„ä¿¡æ¯å…¶å®åªæœ‰ä¸‰ä¸ª: æ ‡ç­¾å, å±æ€§, å­å…ƒç´ .

 æ‰€ä»¥å…¶å®ä¸Šé¢è¿™ä¸ª HTML æ‰€æœ‰çš„ä¿¡æ¯æˆ‘ä»¬éƒ½å¯ä»¥ç”¨åˆæ³•çš„ JavaScript å¯¹è±¡æ¥è¡¨ç¤º:

 #+BEGIN_SRC javascript :results valuse list :exports both
 {
     tag: 'div',
     attrs: { className: 'box', id: 'content'},
     children: [
         {
             tag: 'div',
             arrts: { className: 'title' },
             children: ['Hello']
         },
         {
             tag: 'button',
             attrs: null,
             children: ['Click']
         }
     ]
 }
 #+END_SRC

 ä½ ä¼šå‘ç°,HTML çš„ä¿¡æ¯å’Œ JavaScript æ‰€åŒ…å«çš„ç»“æ„å’Œä¿¡æ¯å…¶å®æ˜¯ä¸€æ ·çš„, æˆ‘ä»¬å¯ä»¥ç”¨ JavaScript å¯¹è±¡æ¥æè¿°æ‰€æœ‰èƒ½ç”¨ HTML è¡¨ç¤ºçš„ UI ä¿¡æ¯. ä½†æ˜¯ç”¨ JavaScript å†™èµ·æ¥å¤ªé•¿äº†, ç»“æ„çœ‹èµ·æ¥åˆä¸æ¸…æ™°, ç”¨ HTML çš„æ–¹å¼å†™èµ·æ¥å°±æ–¹ä¾¿å¾ˆå¤šäº†.

 äºæ˜¯ React.js å°±æŠŠ JavaScript çš„è¯­æ³•æ‰©å±•äº†ä¸€ä¸‹, è®© JavaScript è¯­è¨€èƒ½å¤Ÿæ”¯æŒè¿™ç§ç›´æ¥åœ¨ JavaScript ä»£ç é‡Œé¢ç¼–å†™ç±»ä¼¼ HTML æ ‡ç­¾ç»“æ„çš„è¯­æ³•, è¿™æ ·å†™èµ·æ¥å°±æ–¹ä¾¿å¾ˆå¤šäº†. ç¼–è¯‘çš„è¿‡ç¨‹ä¼šæŠŠç±»ä¼¼ HTML çš„ JSX ç»“æ„è½¬æ¢æˆ JavaScript çš„å¯¹è±¡ç»“æ„.

 ä¸Šé¢çš„ä»£ç :

 #+BEGIN_SRC javascript :results valuse list :exports both
 import React, { Component } from 'react'
 import ReactDOM from 'react-dom'
 import './index.css'

 class Header extends Component {
     render () {
         return (
                 <div>
                 <h1 className='title'>React å°ä¹¦</h1>
                 </div>
         )
     }
 }

 ReactDOM.render(
     <Header />,
     document.getElementById('root')
 )
 #+END_SRC

 ç»è¿‡ç¼–è¯‘ä»¥åä¼šå˜æˆ:

 #+BEGIN_SRC javascript :results valuse list :exports both
 import React, { Component } from 'react'
 import ReactDOM from 'react-dom'
 import './index.css'

 class Header extends Component {
     render () {
         return (
             React.createElement(
                 "div",
                 null,
                 React.createElement(
                     "h1",
                     { className: 'title' },
                     "React å°ä¹¦"
                 )
             )
         )
     }
 }

 ReactDOM.render(
     React.createElement(Header, null),
     document.getElementById('root')
 );
 #+END_SRC

 React.createElement ä¼šæ„å»ºä¸€ä¸ª JavaScript å¯¹è±¡æ¥æè¿°ä½  HTML ç»“æ„çš„ä¿¡æ¯, åŒ…æ‹¬æ ‡ç­¾å, å±æ€§, è¿˜æœ‰å­å…ƒç´ ç­‰. è¿™æ ·çš„ä»£ç å°±æ˜¯åˆæ³•çš„ JavaScript ä»£ç äº†. æ‰€ä»¥ä½¿ç”¨ React å’Œ JSX çš„æ—¶å€™ä¸€å®šè¦ç»è¿‡ç¼–è¯‘çš„è¿‡ç¨‹.

 è¿™é‡Œå†é‡å¤ä¸€é: æ‰€è°“çš„ JSX å…¶å®å°±æ˜¯ JavaScript å¯¹è±¡. æ¯å½“åœ¨ JavaScript ä»£ç ä¸­çœ‹åˆ°è¿™ç§ JSX ç»“æ„çš„æ—¶å€™, è„‘å­é‡Œé¢å°±å¯ä»¥è‡ªåŠ¨åšè½¬åŒ–, è¿™æ ·å¯¹ä½ ç†è§£ React.js çš„ç»„ä»¶å†™æ³•å¾ˆæœ‰å¥½å¤„.

 æœ‰äº†è¿™ä¸ªè¡¨ç¤º HTML ç»“æ„å’Œä¿¡æ¯çš„å¯¹è±¡ä»¥å, å°±å¯ä»¥æ‹¿å»æ„é€ çœŸæ­£çš„ DOM å…ƒç´ , ç„¶åæŠŠè¿™ä¸ª DOM å…ƒç´ å¡åˆ°é¡µé¢ä¸Š. è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœ€åä¸€æ®µä»£ç ä¸­ ReactDOM.render æ‰€å¹²çš„äº‹æƒ…:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ReactDOM.render(
         <Header />,
     document.getElementById('root')
 )
 #+END_SRC

 ReactDOM.render åŠŸèƒ½å°±æ˜¯æŠŠç»„ä»¶æ¸²æŸ“å¹¶ä¸”æ„é€  DOM æ ‘, ç„¶åæ’å…¥åˆ°é¡µé¢ä¸ŠæŸä¸ªç‰¹å®šçš„å…ƒç´ ä¸Š(åœ¨è¿™é‡Œæ˜¯ id ä¸º root çš„ div å…ƒç´ ).

 æ‰€ä»¥å¯ä»¥æ€»ç»“ä¸€ä¸‹ä» JSX åˆ°é¡µé¢åˆ°åº•ç»è¿‡äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹:

 [[file:screenshotImg/44B5EC06-EAEB-4BA2-B3DC-325703E4BA45.png]]

 æœ‰äº›åŒå­¦å¯èƒ½ä¼šé—®, ä¸ºä»€ä¹ˆä¸ç›´æ¥ä» JSX ç›´æ¥æ¸²æŸ“æ„é€  DOM ç»“æ„, è€Œæ˜¯è¦ç»è¿‡ä¸­é—´è¿™ä¹ˆä¸€å±‚å‘¢?

 ç¬¬ä¸€ä¸ªåŸå› æ˜¯, å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªè¡¨ç¤º UI çš„ç»“æ„å’Œä¿¡æ¯çš„å¯¹è±¡ä»¥å, ä¸ä¸€å®šä¼šæŠŠå…ƒç´ æ¸²æŸ“åˆ°æµè§ˆå™¨çš„æ™®é€šé¡µé¢ä¸Š, æˆ‘ä»¬æœ‰å¯èƒ½æŠŠè¿™ä¸ªç»“æ„æ¸²æŸ“åˆ° canvas ä¸Š, æˆ–è€…æ˜¯æ‰‹æœº App ä¸Š. æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šè¦æŠŠ react-dom å•ç‹¬æŠ½ç¦»å‡ºæ¥çš„åŸå› , å¯ä»¥æƒ³è±¡æœ‰ä¸€ä¸ªå« react-canvas å¯ä»¥å¸®æˆ‘ä»¬æŠŠ UI æ¸²æŸ“åˆ° canvas ä¸Š, æˆ–è€…æ˜¯æœ‰ä¸€ä¸ªå« react-app å¯ä»¥å¸®æˆ‘ä»¬æŠŠå®ƒè½¬æ¢æˆåŸç”Ÿçš„ App(å®é™…ä¸Šè¿™ç©æ„å« ReactNative).

 ç¬¬äºŒä¸ªåŸå› æ˜¯, æœ‰äº†è¿™æ ·ä¸€ä¸ªå¯¹è±¡. å½“æ•°æ®å˜åŒ–, éœ€è¦æ›´æ–°ç»„ä»¶çš„æ—¶å€™, å°±å¯ä»¥ç”¨æ¯”è¾ƒå¿«çš„ç®—æ³•æ“ä½œè¿™ä¸ª JavaScript å¯¹è±¡, è€Œä¸ç”¨ç›´æ¥æ“ä½œé¡µé¢ä¸Šçš„ DOM, è¿™æ ·å¯ä»¥å°½é‡å°‘çš„å‡å°‘æµè§ˆå™¨é‡æ’, æå¤§åœ°ä¼˜åŒ–æ€§èƒ½. è¿™ä¸ªåœ¨ä»¥åçš„ç« èŠ‚ä¸­æˆ‘ä»¬ä¼šæåˆ°.

** æ€»ç»“
 è¦è®°ä½å‡ ä¸ªç‚¹:
 - JSX æ˜¯ JavaScript è¯­è¨€çš„ä¸€ç§è¯­æ³•æ‰©å±•, é•¿å¾—åƒ HTML, ä½†å¹¶ä¸æ˜¯ HTML.
 - React.js å¯ä»¥ç”¨ JSX æ¥æè¿°ä½ çš„ç»„ä»¶é•¿ä»€ä¹ˆæ ·çš„.
 - JSX åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå˜æˆç›¸åº”çš„ JavaScript å¯¹è±¡æè¿°.
 - react-dom è´Ÿè´£æŠŠè¿™ä¸ªç”¨æ¥æè¿° UI ä¿¡æ¯çš„ JavaScript å¯¹è±¡å˜æˆ DOM å…ƒç´ , å¹¶ä¸”æ¸²æŸ“åˆ°é¡µé¢ä¸Š.

* ç»„ä»¶çš„ render æ–¹æ³•
React.js ä¸­ä¸€åˆ‡çš†ç»„ä»¶, ç”¨ React.js å†™çš„å…¶å®å°±æ˜¯ React.js ç»„ä»¶. æˆ‘ä»¬åœ¨ç¼–å†™ React.js ç»„ä»¶çš„æ—¶å€™, ä¸€èˆ¬éƒ½éœ€è¦ç»§æ‰¿ React.js çš„ Component(è¿˜æœ‰åˆ«çš„ç¼–å†™ç»„ä»¶çš„æ–¹å¼æˆ‘ä»¬åç»­ä¼šæåˆ°).
ä¸€ä¸ªç»„ä»¶ç±»å¿…é¡»è¦å®ç°ä¸€ä¸ª =render= æ–¹æ³•, è¿™ä¸ª render æ–¹æ³•å¿…é¡»è¦è¿”å›ä¸€ä¸ª JSX å…ƒç´ .
ä½†è¿™é‡Œè¦æ³¨æ„çš„æ˜¯, å¿…é¡»è¦ç”¨ä¸€ä¸ªå¤–å±‚çš„ JSX å…ƒç´ æŠŠæ‰€æœ‰å†…å®¹åŒ…è£¹èµ·æ¥. è¿”å›å¹¶åˆ—å¤šä¸ª JSX å…ƒç´ æ˜¯ä¸åˆæ³•çš„, ä¸‹é¢æ˜¯é”™è¯¯çš„åšæ³•:

#+BEGIN_SRC javascript :results valuse list :exports both
...
    render () {
        return (
                <div>ç¬¬ä¸€ä¸ª</div>
                <div>ç¬¬äºŒä¸ª</div>
        )
    }
...
#+END_SRC

å¿…é¡»è¦ç”¨ä¸€ä¸ªå¤–å±‚å…ƒç´ æŠŠå†…å®¹è¿›è¡ŒåŒ…è£¹:

#+BEGIN_SRC javascript :results valuse list :exports both
...
    render () {
        return (
                <div>
                <div>ç¬¬ä¸€ä¸ª</div>
                <div>ç¬¬äºŒä¸ª</div>
                </div>
        )
    }
...
#+END_SRC

** è¡¨è¾¾å¼æ’å…¥
 åœ¨ JSX å½“ä¸­ä½ å¯ä»¥æ’å…¥ JavaScript çš„è¡¨è¾¾å¼, è¡¨è¾¾å¼è¿”å›çš„ç»“æœä¼šç›¸åº”åœ°æ¸²æŸ“åˆ°é¡µé¢ä¸Š. è¡¨è¾¾å¼ç”¨ {} åŒ…è£¹. ä¾‹å¦‚:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         const word = 'is good'
         return (
               <div>
                 <h1>React å°ä¹¦ {word}</h1>
               </div>
       )
     }
 ...
 #+END_SRC

 é¡µé¢ä¸Šå°±æ˜¾ç¤º"React å°ä¹¦ is good". ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒæ”¹æˆ ={1 + 2}=, å®ƒå°±ä¼šæ˜¾ç¤º "React å°ä¹¦ 3". ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒå†™æˆä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼è¿”å›:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         return (
                 <div>
                   <h1>React å°ä¹¦ {(function () { return 'is good'})()}</h1>
                 </div>
         )
     }
 ...
 #+END_SRC

 ç®€è€Œè¨€ä¹‹,{} å†…å¯ä»¥æ”¾ä»»ä½• JavaScript çš„ä»£ç , åŒ…æ‹¬å˜é‡, è¡¨è¾¾å¼è®¡ç®—, å‡½æ•°æ‰§è¡Œç­‰ç­‰. =render= ä¼šæŠŠè¿™äº›ä»£ç è¿”å›çš„å†…å®¹å¦‚å®åœ°æ¸²æŸ“åˆ°é¡µé¢ä¸Š, éå¸¸çš„çµæ´».

 =è¡¨è¾¾å¼æ’å…¥ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨æ ‡ç­¾å†…éƒ¨, ä¹Ÿå¯ä»¥ç”¨åœ¨æ ‡ç­¾çš„å±æ€§ä¸Š,= ä¾‹å¦‚:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         const className = 'header'
         return (
                 <div className={className}>
                   <h1>React å°ä¹¦</h1>
                 </div>
         )
     }
 ...
 #+END_SRC

 è¿™æ ·å°±å¯ä»¥ä¸º div æ ‡ç­¾æ·»åŠ ä¸€ä¸ªå« header çš„ç±»å.

 æ³¨æ„, ç›´æ¥ä½¿ç”¨ class åœ¨ React.js çš„å…ƒç´ ä¸Šæ·»åŠ ç±»åå¦‚ <div class="xxx"> è¿™ç§æ–¹å¼æ˜¯ä¸åˆæ³•çš„. å› ä¸º class æ˜¯ JavaScript çš„å…³é”®å­—, æ‰€ä»¥ React.js ä¸­å®šä¹‰äº†ä¸€ç§æ–°çš„æ–¹å¼: =className= æ¥å¸®åŠ©æˆ‘ä»¬ç»™å…ƒç´ æ·»åŠ ç±»å.

 è¿˜æœ‰ä¸€ä¸ªç‰¹ä¾‹å°±æ˜¯ for å±æ€§, ä¾‹å¦‚ <label for='male'>Male</label>, å› ä¸º for ä¹Ÿæ˜¯ JavaScript çš„å…³é”®å­—, æ‰€ä»¥åœ¨ JSX ç”¨ =htmlFor= æ›¿ä»£, å³ <label htmlFor='male'>Male</label>. è€Œå…¶ä»–çš„ HTML å±æ€§ä¾‹å¦‚ style ,data-* ç­‰å°±å¯ä»¥åƒæ™®é€šçš„ HTML å±æ€§é‚£æ ·ç›´æ¥æ·»åŠ ä¸Šå».

 æ¡ä»¶è¿”å›
 {} ä¸Šé¢è¯´äº†,JSX å¯ä»¥æ”¾ç½®ä»»ä½•è¡¨è¾¾å¼å†…å®¹. æ‰€ä»¥ä¹Ÿå¯ä»¥æ”¾ JSX, å®é™…ä¸Š, æˆ‘ä»¬å¯ä»¥åœ¨ render å‡½æ•°å†…éƒ¨æ ¹æ®ä¸åŒæ¡ä»¶è¿”å›ä¸åŒçš„ JSX. ä¾‹å¦‚:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         const isGoodWord = true
         return (
                 <div>
                   <h1>
                     React å°ä¹¦
                     {isGoodWord
                      ? <strong> is good</strong>
                      : <span> is not good</span>
                     }
                 </h1>
                 </div>
         )
     }
 ...
 #+END_SRC

 ä¸Šé¢çš„ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ª isGoodWord å˜é‡ä¸º true, ä¸‹é¢æœ‰ä¸ªç”¨ {} åŒ…å«çš„è¡¨è¾¾å¼, æ ¹æ® isGoodWord çš„ä¸åŒè¿”å›ä¸åŒçš„ JSX å†…å®¹. ç°åœ¨é¡µé¢ä¸Šæ˜¯æ˜¾ç¤º React å°ä¹¦ is good. å¦‚æœä½ æŠŠ isGoodWord æ”¹æˆ false ç„¶åå†çœ‹é¡µé¢ä¸Šå°±ä¼šæ˜¾ç¤º React å°ä¹¦ is not good.

 å¦‚æœä½ åœ¨è¡¨è¾¾å¼æ’å…¥é‡Œé¢è¿”å› null , é‚£ä¹ˆ React.js ä¼šä»€ä¹ˆéƒ½ä¸æ˜¾ç¤º, ç›¸å½“äºå¿½ç•¥äº†è¯¥è¡¨è¾¾å¼æ’å…¥. ç»“åˆæ¡ä»¶è¿”å›çš„è¯, æˆ‘ä»¬å°±åšåˆ°æ˜¾ç¤ºæˆ–è€…éšè—æŸäº›å…ƒç´ :

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         const isGoodWord = true
         return (
                 <div>
                   <h1>
                     React å°ä¹¦
                     {isGoodWord
                      ? <strong> is good</strong>
                      : null
                     }
                   </h1>
                 </div>
         )
     }
 ...
 #+END_SRC

 è¿™æ ·å°±ç›¸å½“äºåœ¨ isGoodWord ä¸º true çš„æ—¶å€™æ˜¾ç¤º <strong>is good</strong>, å¦åˆ™å°±éšè—.

 æ¡ä»¶è¿”å› JSX çš„æ–¹å¼åœ¨ React.js ä¸­å¾ˆå¸¸è§, ç»„ä»¶çš„å‘ˆç°æ–¹å¼éšç€æ•°æ®çš„å˜åŒ–è€Œä¸ä¸€æ ·, ä½ å¯ä»¥åˆ©ç”¨ JSX è¿™ç§çµæ´»çš„æ–¹å¼éšæ—¶ç»„åˆæ„å»ºä¸åŒçš„é¡µé¢ç»“æ„.

 å¦‚æœè¿™é‡Œæœ‰äº›åŒå­¦è§‰å¾—æ¯”è¾ƒéš¾ç†è§£çš„è¯, å¯ä»¥å›æƒ³ä¸€ä¸‹, å…¶å® JSX å°±æ˜¯ JavaScript é‡Œé¢çš„å¯¹è±¡, è½¬æ¢ä¸€ä¸‹è§’åº¦, æŠŠä¸Šé¢çš„å†…å®¹ç¿»è¯‘æˆ JavaScript å¯¹è±¡çš„å½¢å¼, ä¸Šé¢çš„ä»£ç å°±å¾ˆå¥½ç†è§£äº†.

** JSX å…ƒç´ å˜é‡
 åŒæ ·çš„, å¦‚æœä½ èƒ½ç†è§£ JSX å…ƒç´ å°±æ˜¯ JavaScript å¯¹è±¡. é‚£ä¹ˆä½ å°±å¯ä»¥è”æƒ³åˆ°, =JSX å…ƒç´ å…¶å®å¯ä»¥åƒ JavaScript å¯¹è±¡é‚£æ ·è‡ªç”±åœ°èµ‹å€¼ç»™å˜é‡, æˆ–è€…ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’, æˆ–è€…ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼.=

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     render () {
         const isGoodWord = true
         const goodWord = <strong> is good</strong>
         const badWord = <span> is not good</span>
           return (
                   <div>
                     <h1>
                       React å°ä¹¦
                       {isGoodWord ? goodWord : badWord}
                       </h1>
                   </div>
           )
 }
 ...
 #+END_SRC

 è¿™é‡Œç»™æŠŠä¸¤ä¸ª JSX å…ƒç´ èµ‹å€¼ç»™äº† goodWord å’Œ badWord ä¸¤ä¸ªå˜é‡, ç„¶åæŠŠå®ƒä»¬ä½œä¸ºè¡¨è¾¾å¼æ’å…¥çš„æ¡ä»¶è¿”å›å€¼. è¾¾åˆ°æ•ˆæœå’Œä¸Šé¢çš„ä¾‹å­ä¸€æ ·, éšæœºè¿”å›ä¸åŒçš„é¡µé¢æ•ˆæœå‘ˆç°.

 å†ä¸¾ä¸€ä¸ªä¾‹å­:

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     renderGoodWord (goodWord, badWord) {
         const isGoodWord = true
         return isGoodWord ? goodWord : badWord
     }

 render () {
     return (
             <div>
               <h1>
                 React å°ä¹¦
                 {this.renderGoodWord(
                         <strong> is good</strong>,
                         <span> is not good</span>
                 )}
               </h1>
               </div>
     )
 }
 ...
 #+END_SRC

è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª renderGoodWord å‡½æ•°, è¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª JSX å…ƒç´ ä½œä¸ºå‚æ•°, å¹¶ä¸”éšæœºè¿”å›å…¶ä¸­ä¸€ä¸ª.
åœ¨ render æ–¹æ³•ä¸­, æˆ‘ä»¬æŠŠä¸Šé¢ä¾‹å­çš„ä¸¤ä¸ª JSX å…ƒç´ ä¼ å…¥ renderGoodWord å½“ä¸­, é€šè¿‡è¡¨è¾¾å¼æ’å…¥æŠŠè¯¥å‡½æ•°è¿”å›çš„ JSX å…ƒç´ æ’å…¥åˆ°é¡µé¢ä¸Š.
ç”¨ React.js æ„å»ºæœªè¯»æ¶ˆæ¯ç»„ä»¶
** ä½¿ç”¨ React.js æ„å»ºä¸€ä¸ªæœªè¯»æ¶ˆæ¯ç»„ä»¶ Notification.
 é€šè¿‡ getNotificationsCount() æ¥è·å–æœªè¯»æ¶ˆæ¯çš„æ•°é‡ , å¦‚æœæœ‰æœªè¯»æ¶ˆæ¯ N æ¡, è€Œä¸” N > 0, é‚£ä¹ˆ Notification ç»„ä»¶æ¸²æŸ“æ˜¾ç¤º:
 #+BEGIN_QUOTE
 <span>æœ‰(N) æ¡æœªè¯»æ¶ˆæ¯</span>
 #+END_QUOTE
 å¦åˆ™æ˜¾ç¤º:
 #+BEGIN_QUOTE
 <span>æ²¡æœ‰æœªè¯»æ¶ˆæ¯</span>
 #+END_QUOTE

 #+BEGIN_SRC javascript :results valuse list :exports both
 // å‡½æ•° getNotificationsCount å·²ç»å¯ä»¥ç›´æ¥è°ƒç”¨

 class Notification extends Component {
     render () {
         const N = getNotificationsCount()
         return(
                 <div>
                     {N>0?<span>æœ‰({N}) æ¡æœªè¯»æ¶ˆæ¯</span>:<span>æ²¡æœ‰æœªè¯»æ¶ˆæ¯</span>}
                 </div>
         )
     }
 }
 #+END_SRC

 æˆ–è€…

 #+BEGIN_SRC javascript :results valuse list :exports both
 // å‡½æ•° getNotificationsCount å·²ç»å¯ä»¥ç›´æ¥è°ƒç”¨

 class Notification extends Component {
     render () {
         // TODO
         let N = getNotificationsCount()
         return (
                 <div>
                     <span>{N>0?`æœ‰(${N}) æ¡æœªè¯»æ¶ˆæ¯`:`æ²¡æœ‰æœªè¯»æ¶ˆæ¯`}</span>
                 </div>
         )
     }
 }
 #+END_SRC
* ç»„ä»¶çš„ç»„åˆ, åµŒå¥—å’Œç»„ä»¶æ ‘
ç»§ç»­æ‹“å±•å‰é¢çš„ä¾‹å­, ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº† Header ç»„ä»¶äº†. å‡è®¾æˆ‘ä»¬ç°åœ¨æ„å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶å« Title, å®ƒä¸“é—¨è´Ÿè´£æ˜¾ç¤ºæ ‡é¢˜. ä½ å¯ä»¥åœ¨ Header é‡Œé¢ä½¿ç”¨ Title ç»„ä»¶:

#+BEGIN_SRC javascript :results valuse list :exports both
class Title extends Component {
    render () {
        return (
                <h1>React å°ä¹¦</h1>
        )
    }
}

class Header extends Component {
    render () {
        return (
                <div>
                <Title />
                </div>
        )
    }
}
#+END_SRC

æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ Header æ ‡ç­¾é‡Œé¢ç›´æ¥ä½¿ç”¨ Title æ ‡ç­¾. å°±åƒæ˜¯ä¸€ä¸ªæ™®é€šçš„æ ‡ç­¾ä¸€æ ·.React.js ä¼šåœ¨ <Title /> æ‰€åœ¨çš„åœ°æ–¹æŠŠ Title ç»„ä»¶çš„ render æ–¹æ³•è¡¨ç¤ºçš„ JSX å†…å®¹æ¸²æŸ“å‡ºæ¥, ä¹Ÿå°±æ˜¯è¯´ <h1>React å°ä¹¦</h1> ä¼šæ˜¾ç¤ºåœ¨ç›¸åº”çš„ä½ç½®ä¸Š.
å¦‚æœç°åœ¨æˆ‘ä»¬åœ¨ Header é‡Œé¢ä½¿ç”¨ä¸‰ä¸ª <Title /> , é‚£ä¹ˆå°±ä¼šæœ‰ä¸‰ä¸ª <h1 /> æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š.

#+BEGIN_SRC javascript :results valuse list :exports both
<div>
<Title />
<Title />
<Title />
</div>
#+END_SRC

è¿™æ ·å¯å¤ç”¨æ€§éå¸¸å¼º, æˆ‘ä»¬å¯ä»¥æŠŠç»„ä»¶çš„å†…å®¹å°è£…å¥½, ç„¶åçµæ´»åœ¨ä½¿ç”¨åœ¨ä»»ä½•ç»„ä»¶å†…. å¦å¤–è¿™é‡Œè¦æ³¨æ„çš„æ˜¯, =è‡ªå®šä¹‰çš„ç»„ä»¶éƒ½å¿…é¡»è¦ç”¨å¤§å†™å­—æ¯å¼€å¤´=, æ™®é€šçš„ HTML æ ‡ç­¾éƒ½ç”¨å°å†™å­—æ¯å¼€å¤´.

ç°åœ¨è®©ç»„ä»¶å¤šèµ·æ¥. æˆ‘ä»¬æ¥æ„å»ºé¢å¤–çš„ç»„ä»¶æ¥æ„å»ºé¡µé¢, å‡è®¾é¡µé¢æ˜¯ç”± Header,Main,Footer å‡ ä¸ªéƒ¨åˆ†ç»„æˆ, ç”±ä¸€ä¸ª Index æŠŠå®ƒä»¬ç»„åˆèµ·æ¥.

#+BEGIN_SRC javascript :results valuse list :exports both
import React, { Component } from 'react';
import ReactDOM from 'react-dom';

class Title extends Component {
    render () {
        return (
                <h1>React å°ä¹¦</h1>
        )
    }
}

class Header extends Component {
    render () {
        return (
                <div>
                    <Title />
                    <h2>This is Header</h2>
                </div>
        )
    }
}

class Main extends Component {
    render () {
        return (
                <div>
                    <h2>This is main content</h2>
                </div>
        )
    }
}

class Footer extends Component {
    render () {
        return (
                <div>
                    <h2>This is footer</h2>
                </div>
        )
    }
}

class Index extends Component {
    render () {
        return (
                <div>
                    <Header />
                    <Main />
                    <Footer />
                </div>
        )
    }
}

ReactDOM.render
      <Index />,
      document.getElementById('root')
)
#+END_SRC

æœ€åé¡µé¢ä¼šæ˜¾ç¤ºå†…å®¹:

[[file:screenshotImg/D57824A9-3F1F-44ED-9CFF-478902261653.png]]

ç»„ä»¶å¯ä»¥å’Œç»„ä»¶ç»„åˆåœ¨ä¸€èµ·, ç»„ä»¶å†…éƒ¨å¯ä»¥ä½¿ç”¨åˆ«çš„ç»„ä»¶.
å°±åƒæ™®é€šçš„ HTML æ ‡ç­¾ä¸€æ ·ä½¿ç”¨å°±å¯ä»¥.
è¿™æ ·çš„ç»„åˆåµŒå¥—, æœ€åæ„æˆä¸€ä¸ªæ‰€è°“çš„ç»„ä»¶æ ‘, å°±æ­£å¦‚ä¸Šé¢çš„ä¾‹å­é‚£æ ·,Index ç”¨äº† Header,Main,Footer,Header åˆä½¿ç”¨äº† Title.
è¿™æ ·ç”¨è¿™æ ·çš„æ ‘çŠ¶ç»“æ„è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»:

[[file:screenshotImg/19BBE4E2-A12E-4657-BA6A-61484F67FA60.png]]

è¿™é‡Œçš„ç»“æ„è¿˜æ˜¯æ¯”è¾ƒç®€å•, å› ä¸ºæˆ‘ä»¬çš„é¡µé¢ç»“æ„å¹¶ä¸å¤æ‚.
å½“é¡µé¢ç»“æ„å¤æ‚èµ·æ¥, æœ‰è®¸å¤šä¸åŒçš„ç»„ä»¶åµŒå¥—ç»„åˆçš„è¯, ç»„ä»¶æ ‘ä¼šç›¸å½“çš„å¤æ‚å’Œåºå¤§.
ç†è§£ç»„ä»¶æ ‘çš„æ¦‚å¿µå¯¹åé¢ç†è§£æ•°æ®æ˜¯å¦‚ä½•åœ¨ç»„ä»¶æ ‘å†…è‡ªä¸Šå¾€ä¸‹æµåŠ¨è¿‡ç¨‹å¾ˆé‡è¦.
* äº‹ä»¶ç›‘å¬
åœ¨ React.js é‡Œé¢ç›‘å¬äº‹ä»¶æ˜¯å¾ˆå®¹æ˜“çš„äº‹æƒ…, ä½ åªéœ€è¦ç»™éœ€è¦ç›‘å¬äº‹ä»¶çš„å…ƒç´ åŠ ä¸Šå±æ€§ç±»ä¼¼äº onClick,onKeyDown è¿™æ ·çš„å±æ€§, ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨è¦ç»™ Title åŠ ä¸Šç‚¹å‡»çš„äº‹ä»¶ç›‘å¬:

#+BEGIN_SRC javascript :results valuse list :exports both
class Title extends Component {
    handleClickOnTitle () {
        console.log('Click on title.')
    }

    render () {
        return (
                <h1 onClick={this.handleClickOnTitle}>React å°ä¹¦</h1>
        )
    }
}
#+END_SRC

åªéœ€è¦ç»™ h1 æ ‡ç­¾åŠ ä¸Š onClick çš„äº‹ä»¶, =onClick ç´§è·Ÿç€æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼æ’å…¥, è¿™ä¸ªè¡¨è¾¾å¼è¿”å›ä¸€ä¸ª Title è‡ªå·±çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•.= å½“ç”¨æˆ·ç‚¹å‡» h1 çš„æ—¶å€™,React.js å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•, æ‰€ä»¥ä½ åœ¨æ§åˆ¶å°å°±å¯ä»¥çœ‹åˆ° Click on title. æ‰“å°å‡ºæ¥.

åœ¨ React.js ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨æµè§ˆå™¨åŸç”Ÿçš„ addEventListener è¿›è¡Œäº‹ä»¶ç›‘å¬.React.js å¸®æˆ‘ä»¬å°è£…å¥½äº†ä¸€ç³»åˆ—çš„ on* çš„å±æ€§, å½“ä½ éœ€è¦ä¸ºæŸä¸ªå…ƒç´ ç›‘å¬æŸä¸ªäº‹ä»¶çš„æ—¶å€™, åªéœ€è¦ç®€å•åœ°ç»™å®ƒåŠ ä¸Š on* å°±å¯ä»¥äº†. è€Œä¸”ä½ ä¸éœ€è¦è€ƒè™‘ä¸åŒæµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜,React.js éƒ½å¸®æˆ‘ä»¬å°è£…å¥½è¿™äº›ç»†èŠ‚äº†.

React.js å°è£…äº†ä¸åŒç±»å‹çš„äº‹ä»¶, è¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾, æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒå®˜ç½‘æ–‡æ¡£:[[https://reactjs.org/docs/events.html#supported-events][SyntheticEvent - React]], å¤šå°è¯•ä¸åŒçš„äº‹ä»¶. å¦å¤–è¦æ³¨æ„çš„æ˜¯, è¿™äº›äº‹ä»¶å±æ€§åéƒ½å¿…é¡»è¦ç”¨é©¼å³°å‘½åæ³•.

=æ²¡æœ‰ç»è¿‡ç‰¹æ®Šå¤„ç†çš„è¯, è¿™äº› on* çš„äº‹ä»¶ç›‘å¬åªèƒ½ç”¨åœ¨æ™®é€šçš„ HTML çš„æ ‡ç­¾ä¸Š, è€Œä¸èƒ½ç”¨åœ¨ç»„ä»¶æ ‡ç­¾ä¸Š. ä¹Ÿå°±æ˜¯è¯´,<Header onClick={â€¦} /> è¿™æ ·çš„å†™æ³•ä¸ä¼šæœ‰ä»€ä¹ˆæ•ˆæœçš„.= è¿™ä¸€ç‚¹è¦æ³¨æ„, ä½†æ˜¯æœ‰åŠæ³•å¯ä»¥åšåˆ°è¿™æ ·çš„ç»‘å®š, ä»¥åæˆ‘ä»¬ä¼šæåŠ. ç°åœ¨åªè¦è®°ä½ä¸€ç‚¹å°±å¯ä»¥äº†: è¿™äº› on* çš„äº‹ä»¶ç›‘å¬åªèƒ½ç”¨åœ¨æ™®é€šçš„ HTML çš„æ ‡ç­¾ä¸Š, è€Œä¸èƒ½ç”¨åœ¨ç»„ä»¶æ ‡ç­¾ä¸Š.

** event å¯¹è±¡
 å’Œæ™®é€šæµè§ˆå™¨ä¸€æ ·, äº‹ä»¶ç›‘å¬å‡½æ•°ä¼šè¢«è‡ªåŠ¨ä¼ å…¥ä¸€ä¸ª event å¯¹è±¡, è¿™ä¸ªå¯¹è±¡å’Œæ™®é€šçš„æµè§ˆå™¨ event å¯¹è±¡æ‰€åŒ…å«çš„æ–¹æ³•å’Œå±æ€§éƒ½åŸºæœ¬ä¸€è‡´. ä¸åŒçš„æ˜¯ React.js ä¸­çš„ event å¯¹è±¡å¹¶ä¸æ˜¯æµè§ˆå™¨æä¾›çš„, è€Œæ˜¯å®ƒè‡ªå·±å†…éƒ¨æ‰€æ„å»ºçš„.React.js å°†æµè§ˆå™¨åŸç”Ÿçš„ event å¯¹è±¡å°è£…äº†ä¸€ä¸‹, å¯¹å¤–æä¾›ç»Ÿä¸€çš„ API å’Œå±æ€§, è¿™æ ·ä½ å°±ä¸ç”¨è€ƒè™‘ä¸åŒæµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜. è¿™ä¸ª event å¯¹è±¡æ˜¯ç¬¦åˆ W3C æ ‡å‡†(W3C UI Events) çš„, å®ƒå…·æœ‰ç±»ä¼¼äº event.stopPropagation, event.preventDefault è¿™ç§å¸¸ç”¨çš„æ–¹æ³•.

 æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹, è¿™æ¬¡å°è¯•å½“ç”¨æˆ·ç‚¹å‡» h1 çš„æ—¶å€™, æŠŠ h1 çš„ innerHTML æ‰“å°å‡ºæ¥:

 #+BEGIN_SRC javascript :results valuse list :exports both
 class Title extends Component {
     handleClickOnTitle (e) {
         console.log(e.target.innerHTML)
     }

     render () {
         return (
                 <h1 onClick={this.handleClickOnTitle}>React å°ä¹¦</h1>
         )
     }
 }
 #+END_SRC

 å†çœ‹çœ‹æ§åˆ¶å°, æ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™å°±ä¼šæ‰“å°"React å°ä¹¦".

** å…³äºäº‹ä»¶ä¸­çš„ this
 ä¸€èˆ¬åœ¨æŸä¸ªç±»çš„å®ä¾‹æ–¹æ³•é‡Œé¢çš„ this æŒ‡çš„æ˜¯è¿™ä¸ªå®ä¾‹æœ¬èº«. ä½†æ˜¯ä½ åœ¨ä¸Šé¢çš„ handleClickOnTitle ä¸­æŠŠ this æ‰“å°å‡ºæ¥, ä½ ä¼šçœ‹åˆ° this æ˜¯ null æˆ–è€… undefined.

 #+BEGIN_SRC javascript :results valuse list :exports both
 ...
     handleClickOnTitle (e) {
         console.log(this) // => null or undefined
     }
 ...
 #+END_SRC

 è¿™æ˜¯å› ä¸º React.js è°ƒç”¨ä½ æ‰€ä¼ ç»™å®ƒçš„æ–¹æ³•çš„æ—¶å€™, å¹¶ä¸æ˜¯é€šè¿‡å¯¹è±¡æ–¹æ³•çš„æ–¹å¼è°ƒç”¨ (this.handleClickOnTitle), è€Œæ˜¯ç›´æ¥é€šè¿‡å‡½æ•°è°ƒç”¨ (handleClickOnTitle), æ‰€ä»¥äº‹ä»¶ç›‘å¬å‡½æ•°å†…å¹¶ä¸èƒ½é€šè¿‡ this è·å–åˆ°å®ä¾‹.

 =å¦‚æœä½ æƒ³åœ¨äº‹ä»¶å‡½æ•°å½“ä¸­ä½¿ç”¨å½“å‰çš„å®ä¾‹, ä½ éœ€è¦æ‰‹åŠ¨åœ°å°†å®ä¾‹æ–¹æ³• bind åˆ°å½“å‰å®ä¾‹ä¸Šå†ä¼ å…¥ç»™ React.js.=


 #+BEGIN_SRC javascript :results valuse list :exports both
 class Title extends Component {
     handleClickOnTitle (e) {
         console.log(this)
     }

     render () {
         return (
                 <h1 onClick={this.handleClickOnTitle.bind(this)}>React å°ä¹¦</h1>
         )
     }
 }
 #+END_SRC

 bind ä¼šæŠŠå®ä¾‹æ–¹æ³•ç»‘å®šåˆ°å½“å‰å®ä¾‹ä¸Š, ç„¶åæˆ‘ä»¬å†æŠŠç»‘å®šåçš„å‡½æ•°ä¼ ç»™ React.js çš„ onClick äº‹ä»¶ç›‘å¬. è¿™æ—¶å€™ä½ å†çœ‹çœ‹, ç‚¹å‡» h1 çš„æ—¶å€™, å°±ä¼šæŠŠå½“å‰çš„å®ä¾‹æ‰“å°å‡ºæ¥:

 [[file:screenshotImg/07937EC0-AAFE-4FD5-ABB7-06A69EBF54C7.png]]

 ä½ ä¹Ÿå¯ä»¥åœ¨ bind çš„æ—¶å€™ç»™äº‹ä»¶ç›‘å¬å‡½æ•°ä¼ å…¥ä¸€äº›å‚æ•°:


 #+BEGIN_SRC javascript :results valuse list :exports both
 class Title extends Component {
     handleClickOnTitle (word, e) {
         console.log(this, word)
     }

     render () {
         return (
                 <h1 onClick={this.handleClickOnTitle.bind(this, 'Hello')}>React å°ä¹¦</h1>
         )
     }
 }
 #+END_SRC

 è¿™ç§ bind æ¨¡å¼åœ¨ React.js çš„äº‹ä»¶ç›‘å¬å½“ä¸­éå¸¸å¸¸è§,bind ä¸ä»…å¯ä»¥å¸®æˆ‘ä»¬æŠŠäº‹ä»¶ç›‘å¬æ–¹æ³•ä¸­çš„ this ç»‘å®šåˆ°å½“å‰ç»„ä»¶å®ä¾‹ä¸Š, è¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨åœ¨æ¸²æŸ“åˆ—è¡¨å…ƒç´ çš„æ—¶å€™, æŠŠåˆ—è¡¨å…ƒç´ ä¼ å…¥äº‹ä»¶ç›‘å¬å‡½æ•°å½“ä¸­â€”â€”è¿™ä¸ªå°†åœ¨ä»¥åçš„ç« èŠ‚æåŠ.

 å¦‚æœæœ‰äº›åŒå­¦å¯¹ JavaScript çš„ this æ¨¡å¼æˆ–è€… bind å‡½æ•°çš„ä½¿ç”¨æ–¹å¼ä¸æ˜¯ç‰¹åˆ«äº†è§£åˆ°è¯, å¯èƒ½ä¼šå¯¹è¿™éƒ¨åˆ†å†…å®¹ä¼šæœ‰äº›è¿·æƒ‘, å¯ä»¥è¡¥å……å¯¹ JavaScript çš„ [[https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/this][this]] å’Œ [[https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind][bind]] ç›¸å…³çš„çŸ¥è¯†å†æ¥å›é¡¾è¿™éƒ¨åˆ†å†…å®¹.

** æ€»ç»“
 ä¸º React çš„ç»„ä»¶æ·»åŠ äº‹ä»¶ç›‘å¬æ˜¯å¾ˆç®€å•çš„äº‹æƒ…, ä½ åªéœ€è¦ä½¿ç”¨ React.js æä¾›äº†ä¸€ç³»åˆ—çš„ on* æ–¹æ³•å³å¯.

 React.js ä¼šç»™æ¯ä¸ªäº‹ä»¶ç›‘å¬ä¼ å…¥ä¸€ä¸ª event å¯¹è±¡, è¿™ä¸ªå¯¹è±¡æä¾›çš„åŠŸèƒ½å’Œæµè§ˆå™¨æä¾›çš„åŠŸèƒ½ä¸€è‡´, è€Œä¸”å®ƒæ˜¯å…¼å®¹æ‰€æœ‰æµè§ˆå™¨çš„.

 React.js çš„äº‹ä»¶ç›‘å¬æ–¹æ³•éœ€è¦æ‰‹åŠ¨ bind åˆ°å½“å‰å®ä¾‹, è¿™ç§æ¨¡å¼åœ¨ React.js ä¸­éå¸¸å¸¸ç”¨.

** ä¸èƒ½æ‘¸çš„ç‹—
 æœ‰ä¸€åªç‹—, ä¸å…è®¸åˆ«äººæ‘¸å®ƒ, ä¸€æ—¦æ‘¸å®ƒå°±ä¼šå«, ç„¶åå°±è·‘äº†.

 å®Œæˆ Dog ç»„ä»¶, å½“ç”¨æˆ·ç‚¹å‡»çš„æ—¶å€™ä¼šæ‰§è¡Œè‡ªèº«çš„ bark å’Œ run æ–¹æ³•.

 #+BEGIN_SRC javascript :results valuse list :exports both
 class Dog extends Component {
     bark () {
         console.log('bark')
     }

     run () {
         console.log('run')
     }

     render () {
         return (<div onClick={()=>{this.bark();this.run();}}>DOG</div>)
     }
 }
 #+END_SRC

 #+BEGIN_SRC javascript :results valuse list :exports both
 class Dog extends Component {
     bark () {
         console.log('bark')
     }

     run () {
         console.log('run')
     }

     handleOnClick () {
         this.bark();
         this.run();
     }

     render () {
         return (<div onClick={this.handleOnClick.bind(this)}>DOG</div>)
     }
 }
 #+END_SRC

 å¦‚æœä¸ä½¿ç”¨ =bind(this)=, å‡ºç°å¦‚ä¸‹é”™è¯¯:
 [[file:screenshotImg/FireShot%20Capture%20041%20-%20Hello,%20world!%20-%20http___localhost_3000_.png]]
